(function(a){jQuery.fn.center=function(){this.css("top",Math.ceil((a(window).height()-this.height()-200)/2+a(window).scrollTop())+"px");this.css("left",Math.ceil((a(window).width()-this.width()-665)/2+a(window).scrollLeft())+"px");return this};WPop_Nav={groups:[],init:function(){a("li","#wpop_nav").each(function(c){var e=a(this).attr("id").substring(9);var d="#wpop_options_"+e;a(d).hide();if(c==0){a(d).show();a(this).addClass("current")}else{if(c==1){a(this).addClass("alt")}}WPop_Nav.groups.push(e)});a("a","#wpop_nav").each(function(){a(this).bind("click",function(){WPop_Nav.current(this);return false})})},before:function(d){var c=a.inArray(a(d).attr("id").substring(9),WPop_Nav.groups)-1;if(c<0){return null}return WPop_Nav.groups[c]},after:function(d){var c=a.inArray(a(d).attr("id").substring(9),WPop_Nav.groups)+1;if(c==WPop_Nav.groups.length){return null}return WPop_Nav.groups[c]},current:function(d){var c=a(d).parent().get(0);var f=a(c).attr("id").substring(9);var e=a("div:visible","#wpop_content").attr("id").substring(13);var g=this.after(c);a("#wpop_options_"+e).fadeOut("fast",function(){a("#wpop_nav_"+e).removeClass("current");a(c).addClass("current");a("li","#wpop_nav").removeClass("alt");if(g){a("#wpop_nav_"+g).addClass("alt")}a("#wpop_options_"+f).fadeIn("fast")})}};WPop_ColorPicker={current:"",init:function(){a(".wpop_colorpicker").ColorPicker({onBeforeShow:function(d){WPop_ColorPicker.current=this;var c=a(this).children("div").css("backgroundColor");if(c=="transparent"){c="#ffffff"}a(this).ColorPickerSetColor(WPop_ColorPicker.fixRGB(c))},onShow:function(c){a(c).fadeIn("fast");return false},onHide:function(c){a(c).fadeOut("fast");return false},onChange:function(c,e,d){if(e=="NaNNaNNaN"){return}a(WPop_ColorPicker.current).children("div").css("backgroundColor","#"+e);a(WPop_ColorPicker.current).next("input").attr("value","#"+e)}});a(".wpop_color").bind("change keypress",function(){try{a(this).prev("div").children("div").animate({backgroundColor:a(this).val()},"fast")}catch(c){a(this).prev("div").children("div").css("backgroundColor",a(this).val())}})},fixRGB:function(d){var c=d.slice(4,-1).split(",");return{r:parseInt(c[0]),g:parseInt(c[1]),b:parseInt(c[2])}}};WPop_Uploader={init:function(){a(".upload_remove").bind("click",function(){WPop_Uploader.remove(this)});a(".upload_button").click(function(){var e=this;var c=a(this).prev("input");var d=a(this).next("input").val();var f=a(a(this).parents(".option").get(0)).prev("h3").text();tb_show(f,"media-upload.php?post_id="+d+"&amp;type=image&amp;TB_iframe=1");window.send_to_editor=function(h){tb_remove();var g=a("img",h).attr("src");a(c).val(g);WPop_Uploader.display(c)};return false})},display:function(c){var d=a(c).nextAll("div");d.html('<div style="display: none;"><a href="'+a(c).val()+'" class="upload_fullsize" target="_blank" title="View full size"><img src="'+a(c).val()+'" /></a><a href="#" class="upload_remove" title="Remove">Remove</a></div>');a("div",d).fadeIn();a(".upload_remove",d).bind("click",function(){WPop_Uploader.remove(this);return false})},remove:function(c){var d=a(c).parents(".input").get(0);a(".upload_preview div",d).fadeOut("fastx",function(){a(this).remove();a(".upload",d).val("")})}};WPop_Scheme={init:function(){a(".scheme").click(function(){WPop_Scheme.set(a(this).attr("id").substring(7));return false})},set:function(c){a(".section_scheme .current").fadeOut("fast",function(){a(".section_scheme .current").appendTo("#scheme-"+c).fadeIn("fast");a(".section_scheme input").val(c)})}};var b=[];a.fn.WPopSlider=function(){var c=[];this.each(function(d){if(a.inArray(a(this).attr("name"),c)==-1){c.push(a(this).attr("name"))}});a.each(c,function(d){b[d]={source_name:null,entries_name:null,$source:null,$entries:null,source:"",init:function(e){var f=this;f.source_name=e;f.findEntriesElement();f.$source=a("input[name="+f.source_name+"]");f.$entries=a("input[name="+f.entries_name+"]");if(a(".slider_source:checked",f.$source.parents(".input")).length>0){f.source=a(".slider_source:checked",f.$source.parents(".input")).val();f.showOptions(false)}a(".wpop_sortable",f.$entries.parents(".input")).sortable({update:function(g,h){f.updateEntries(this)}});f.bindRadios();f.bindEntries();a(".slider_entries_add .button",f.$entries.parents(".input")).click(function(){f.addEntry()})},findEntriesElement:function(){var e=this;a(".slider_entries_reference").each(function(){if("wpop_theme_"+a(this).text()==e.source_name){e.entries_name=a(this).prev().attr("name");return true}});return false},bindRadios:function(){var e=this;a(":radio",e.$source.parents(".input")).click(function(){if(e.source==a(this).val()){return}e.source=a(this).val();e.showOptions(true)})},showOptions:function(h){var g=this;var f=g.entries_name+"_"+g.source;if(a(".slider_entries_options:visible",g.$entries.parent(".input")).length>0){a(".slider_entries_options:visible",g.$entries.parent(".input")).fadeOut("normal",function(){a("select[name="+f+"]").fadeIn()})}else{a("select[name="+f+"]").fadeIn()}if(h){var e=a(".slider_entries ul",g.$entries.parent(".input"));a("li",e).fadeOut("normal",function(){g.$entries.val("");e.empty()})}},bindEntries:function(){var e=this;a(".slider_entries_remove",e.$entries.parents(".input")).unbind();a(".slider_entries_remove",e.$entries.parents(".input")).click(function(){var f=a(this).next(".slider_entry_value").text();a(".slider_entries_remove").parents("li").each(function(){if(a(".slider_entry_value",a(this)).text()==f){a(this).fadeOut("normal",function(){e.removeEntry(f);a(this).remove()})}});return false})},getEntries:function(){var f=this;var e=[];if(/,/.test(f.$entries.val())){e=f.$entries.val().split(",")}else{if(f.$entries.val()!=""){e.push(f.$entries.val())}}return e},addEntry:function(){var i=this;var h=a(":selected",a("select:visible",i.$entries.parents(".input")));var g=a(".slider_entries ul",i.$entries.parent(".input"));var e=i.getEntries();if(a.inArray(h.val(),e)>-1){return false}var f=a("#slider_entries_dummy_entry").clone().attr("id","").show();a("h4",f).html(h.text());a(".slider_entry_value",f).text(h.val());f=a("<li></li>").wrapInner(f);f.hide().addClass("widget entry").appendTo(g);f.fadeIn();e.push(h.val());i.$entries.val(e.join(","));i.bindEntries()},removeEntry:function(h){var g=this;var e=g.getEntries();var f=a.inArray(h,e);if(f>-1){e.splice(f,1)}g.$entries.val(e.join(","))},updateEntries:function(f){var g=this;var e=[];a(".slider_entry_value",f).each(function(){e.push(a(this).text())});g.$entries.val(e.join(","))}};b[d].init(this.toString())})};WPop_Slider={init:function(){a(".slider_source").WPopSlider()}};WPop_Form={init:function(){a("#wpop_theme_form").submit(function(){WPop.flashMessage("Saving your settings, please wait.","loading");a.post("admin-ajax.php",{action:"wpop_theme_save_options",data:a("#wpop_theme_form *").serialize()},function(c){WPop.flashMessage(c.text,c.type)},"json");return false})}};WPop={init:function(){a("#wpop_message").center();WPop_Nav.init();WPop_ColorPicker.init();WPop_Uploader.init();WPop_Scheme.init();WPop_Form.init();WPop_Slider.init();a("#wpop_container").show()},flashMessage:function(e,d){var c=a("#wpop_message");a(c).html(e).center();a(c).removeClass("wpop_message_loading wpop_message_succeed wpop_message_error wpop_message_info");a(c).addClass("wpop_message_"+d);a(c).fadeIn("fast",function(){window.setTimeout(function(){a(c).fadeOut("fast")},1500)})}}})(jQuery);jQuery(document).ready(function(){WPop.init()});